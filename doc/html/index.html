<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Viscoelastic Fault -  Elastic approach: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Viscoelastic Fault -  Elastic approach
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Viscoelastic Fault - Elastic approach Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section warning"><dt>Warning</dt><dd>This code is under development and has not been properly benchmarked. Feel free to use it, but be warned that it is distributed WITHOUT ANY WARRANTY. Please, contact Juan Rodriguez-Gonzalez (<a href="#" onclick="location.href='mai'+'lto:'+'jrg'+'le'+'z@u'+'md'+'.ed'+'u'; return false;">jrgle<span style="display: none;">.nosp@m.</span>z@um<span style="display: none;">.nosp@m.</span>d.edu</a>) if you make any significant modifications to this code.</dd></dl>
<h1><a class="anchor" id="intro"></a>
Introduction</h1>
<p>This code simulates the deformation of a viscoelastic medium in presence of a discrete fault under the anti-plane shear approximation. Under this assumption there is no displacement in the modeled plane <img class="formulaInl" alt="$(u_{x}=u_{y}=0)$" src="form_93.png"/> and there is no spatial variation in the direction perpendicular to the modeled plane <img class="formulaInl" alt="$(\partial z=0)$" src="form_1.png"/>. We solve the equilibrium equation for an elastic medium in with an isotropic constitutive relationship in which the elastic strain is relaxed by viscous creep. Under this conditions, the right-hand side depends on the displacement values from the previous time step.</p>
<h2><a class="anchor" id="equations"></a>
Viscoelastic approximation</h2>
<p>We solve the equation of equilibrium for stress in a continuum medium:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[\partial_{i} \sigma = f^g_j \]" src="form_171.png"/>
</p>
<p>where <img class="formulaInl" alt="$i$" src="form_3.png"/> and <img class="formulaInl" alt="$j$" src="form_4.png"/> run from 1 to 3 and designate spatial coordinate, <img class="formulaInl" alt="$\sigma$" src="form_5.png"/> is the stress tensor and <img class="formulaInl" alt="$\boldsymbol{f^g}$" src="form_151.png"/> is the total external force, in this case, only the gravitational force <img class="formulaInl" alt="$f^g_j=f^g_j=\rho g \left(1-\alpha T \right) \delta_{iy}$" src="form_147.png"/>. We assume a linear maxwel model in which the total strain <img class="formulaInl" alt="$ \varepsilon $" src="form_162.png"/> is the sum of the elastic strain <img class="formulaInl" alt="$ \varepsilon^e $" src="form_118.png"/> and the viscous strain <img class="formulaInl" alt="$ \varepsilon^v $" src="form_119.png"/>:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \varepsilon_{ij} = \varepsilon^e_{ij} + \varepsilon^v_{ij} + \varepsilon^0_{ij} \]" src="form_172.png"/>
</p>
<p>where <img class="formulaInl" alt="$ \varepsilon^0 $" src="form_164.png"/> is the initial strain. We will use a semi-elastic approach <a class="el" href="citelist.html#CITEREF_zienkiewicz_cormeau_74">[5]</a> <a class="el" href="citelist.html#CITEREF_yamasaki_houseman_12">[4]</a> for which we assume a constitutive relation between stress and elastic strain:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma_{ij} = C_{ijkl} \varepsilon_{kl} + \sigma^0_{ij}\]" src="form_165.png"/>
</p>
<p>where <img class="formulaInl" alt="$ C $" src="form_117.png"/> is the elastic stiffness tensor and <img class="formulaInl" alt="$ \sigma^0 $" src="form_166.png"/> is the initial stress. This can be interpreted as the stress being relaxed by viscous creep:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma_{ij} = C_{ijkl} \left( \varepsilon_{kl} - \varepsilon^v_{kl} -\varepsilon^0_{kl} \right) + \sigma^0_{ij} \]" src="form_167.png"/>
</p>
<p>In an isotropic medium:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma_{ij} = \lambda \left( \epsilon_{kk} - \epsilon^0_{kk} \right) \delta_{ij} + 2\mu \left( \varepsilon_{ij} - \varepsilon^v_{ij} - \varepsilon^0_{ij} \right) + \sigma^0_{ij} \]" src="form_246.png"/>
</p>
<p>where <img class="formulaInl" alt="$ \lambda $" src="form_204.png"/> is the first Lam√© parameter and <img class="formulaInl" alt="$\mu$" src="form_15.png"/> is the shear modulus. The strain can be expressed in terms of the displacement <img class="formulaInl" alt="$ u_i $" src="form_121.png"/>:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \varepsilon_{ij} = \frac{1}{2} \left( \partial_j u_i + \partial_i u_j \right) \]" src="form_170.png"/>
</p>
<p>The viscous strain rate <img class="formulaInl" alt="$ \dot \varepsilon^v $" src="form_126.png"/> depends on the stress tensor:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \dot \varepsilon^v_{ij} = \beta_{ij}(\sigma) \]" src="form_127.png"/>
</p>
<p>where <img class="formulaInl" alt="$ \beta $" src="form_128.png"/> are given functions. A relationship to link the viscous strain rate and the elastic strain is given in the next section.</p>
<p>We can now use this in the momentum equation and we have:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_i \left( \lambda \varepsilon_{kk} \delta_{ij} + 2 \mu \varepsilon_{ij} \right) = f_j + f^v_j \]" src="form_191.png"/>
</p>
<p>where</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ f_j = f^g_j + \partial_i \left( \lambda \varepsilon^0_{kk}\delta_{ij} + 2 \mu \varepsilon^0_{ij} - \sigma^0_{ij} \right) \]" src="form_264.png"/>
</p>
<p>This equation is very similar to the elasticity equation but with an internal force due to the viscous coupling:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ f^v_j = \partial_i \left( 2 \mu \varepsilon^v_{ij} \right) \]" src="form_178.png"/>
</p>
<h2><a class="anchor" id="num_approach"></a>
Numerical approach</h2>
<p>To use a semi-elastic approach we need to manipulate the constitutive equation to find a relation between viscous and elastic strains. To achieve this, the first step is to express the viscous strain in terms of the viscous strain rate. We replace the strain rate by the forward derivative:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \dot \varepsilon^v(t_n) = \frac{\varepsilon^v(t_{n+1}) - \varepsilon^v(t_n)}{\Delta t_n} \]" src="form_183.png"/>
</p>
<p>where the subscripts <img class="formulaInl" alt="$ n $" src="form_134.png"/> and <img class="formulaInl" alt="$ n+1 $" src="form_135.png"/> indicate the current and future time steps and <img class="formulaInl" alt="$ \Delta t_{n+1} = t_{n+1} - t_n $" src="form_179.png"/> is the time step increment. Therefore, we can write the viscous strain at a given time step as:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \varepsilon^v(t_{n+1}) = \varepsilon^v(t_{n}) + \Delta t_{n+1} \dot \varepsilon(t_{n}) \]" src="form_185.png"/>
</p>
<p>Following <a class="el" href="citelist.html#CITEREF_yamasaki_houseman_12">[4]</a>, we use the following relation between viscous strain rate and elastic strain:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \dot \varepsilon^v_{ij} = \frac{\mu}{\eta} \left( \varepsilon_{ij} - \frac {1}{3} \epsilon_{kk}\delta_{ij} \right) \]" src="form_193.png"/>
</p>
<p>where <img class="formulaInl" alt="$ \eta $" src="form_138.png"/> is the viscosity. And at time step n+1 we will need to solve the equation:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_i \left( \lambda \varepsilon_{kk}(t_{n+1}) \delta_{ij} + 2 \mu \varepsilon_{ij}(t_{n+1}) \right) = f^g_j(t_{n+1}) + f^{v}_j(t_{n+1}) \]" src="form_186.png"/>
</p>
<p>where the internal elastic force now only depends on the strain and past viscous strain rate:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ f^{v}_j(t_{n+1}) = \partial_i \left( 2\mu \varepsilon^v_{ij}(t_{n+1}) \right) = \partial_i \left\{ 2\mu \left[\varepsilon^v_{ij}(t_n) + \frac{\mu \Delta t_{n+1}}{\eta} \left(\varepsilon_{ij}(t_n) - \frac{1}{3} \varepsilon_{kk}(t_n) \delta_{ij} \right) \right] \right\} \]" src="form_229.png"/>
</p>
<p>Therefore, we will follow the next scheme to solve the problem:</p>
<ol type="1">
<li>Set initial conditions <img class="formulaInl" alt="$ (n = 0) $" src="form_243.png"/> for the stress <img class="formulaInl" alt="$\sigma(t_0) = \sigma^0$" src="form_199.png"/>, displacement <img class="formulaInl" alt="$ \boldsymbol{u}(t_0) $" src="form_211.png"/> and viscous strain <img class="formulaInl" alt="$ \varepsilon^v(t_0) $" src="form_212.png"/>.</li>
<li>Compute the viscous strain <img class="formulaInl" alt="$ \varepsilon^v(t_{n+1}) $" src="form_200.png"/>, which depends on <img class="formulaInl" alt="$ \varepsilon(t_n) $" src="form_215.png"/> and <img class="formulaInl" alt="$ \varepsilon^v(t_n) $" src="form_214.png"/>.</li>
<li>Solve the momentum equation to obtain the displacement <img class="formulaInl" alt="$ \varepsilon (t_{n+1}) $" src="form_201.png"/></li>
<li>Compute <img class="formulaInl" alt="$ \sigma (t_{n+1}) $" src="form_202.png"/>.</li>
<li>Update <img class="formulaInl" alt="$ n \leftarrow n+1 $" src="form_203.png"/> and repeat steps 2 to 5.</li>
</ol>
<h3><a class="anchor" id="anti_plane"></a>
Anti-plane shear approximation</h3>
<p>The equations presented until now are valid for viscoelastic problems in any dimensions. However, solving it can be computationally demanding. For certain problems it is enough to solve the equation under certain approximations. In this case we are going to model the displacement in the <img class="formulaInl" alt="$x-y$" src="form_41.png"/> plane produced by a fault that runs parallel to the <img class="formulaInl" alt="$y-z$" src="form_42.png"/> plane and is sliding parallel to the <img class="formulaInl" alt="$z$" src="form_43.png"/> direction. </p>
<div class="image">
<img src="aps.png" alt="aps.png"/>
<div class="caption">
Figure 1: Schematic representation of a fault and the modeled plane</div></div>
 In this case, we can considered that displacement only occurs in the <img class="formulaInl" alt="$z$" src="form_43.png"/> direction <img class="formulaInl" alt="$ (u_{x}=u_{y}=0) $" src="form_248.png"/>. Moreover, under this approximation no magnitude can vary along the <img class="formulaInl" alt="$ z $" src="form_249.png"/> direction <img class="formulaInl" alt="$(\frac{\partial}{\partial z}=0)$" src="form_44.png"/>. Therefore, under this approximation <img class="formulaInl" alt="$ \varepsilon_{xx} = \varepsilon_{yy} = \varepsilon_{zz} = \varepsilon_{xy} = \varepsilon_{yx}=0$" src="form_250.png"/>, * <img class="formulaInl" alt="$ \varepsilon^v_{xx} = \varepsilon^v_{yy} = \varepsilon^v_{zz} = \varepsilon^v_{xy} = \varepsilon^v_{yx} = 0 $" src="form_251.png"/> and <img class="formulaInl" alt="$ \sigma_{xx} = \sigma_{yy} = \sigma_{zz} = \sigma_{xy} = \sigma_{yx} = 0 $" src="form_252.png"/>. In addition, we neglect the gravitational force. Therefore, the governing equations are reduced to:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_i \left( \mu \partial_i u_z \right) = f^v_z \]" src="form_224.png"/>
</p>
<p>where</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ f^v_z(t_{n+1}) = \partial_i \left( 2\mu \varepsilon^v_{iz}(t_{n+1}) \right) = \partial_i \left[ 2 \mu \left(\varepsilon^v_{iz}(t_n) + \frac{\mu \Delta t_{n+1}}{2 * \eta} \partial_i u_z(t_n) \right) \right] \]" src="form_253.png"/>
</p>
<h1><a class="anchor" id="model"></a>
Modeling</h1>
<h2><a class="anchor" id="setup"></a>
Setup</h2>
<p>Here we will solve the visco-elastic equation in a two-dimensional domain of dimensions <img class="formulaInl" alt="$a$" src="form_56.png"/> by <img class="formulaInl" alt="$b$" src="form_57.png"/>. We will solve for the displacement in the direction perpendicular to the plane <img class="formulaInl" alt="$(u_z)$" src="form_105.png"/> caused by a fault also perpendicular to the modeled plane.</p>
<p>There are four possible boundary conditions:</p>
<ul>
<li><img class="formulaInl" alt="$\Gamma_0$" src="form_59.png"/> - The locked part above the fault, with imposed zero displacement, <img class="formulaInl" alt="$u_z=0$" src="form_106.png"/> (homogeneous Dirichlet boundary conditions).</li>
<li><img class="formulaInl" alt="$\Gamma_1$" src="form_61.png"/> - Regions of imposed displacement, <img class="formulaInl" alt="$u_z=U$" src="form_219.png"/> (non-homogeneous Dirichlet boundary conditions).</li>
<li><img class="formulaInl" alt="$\Gamma_2$" src="form_63.png"/> - Zero tangential stress boundaries, <img class="formulaInl" alt="$ n_i \sigma_{iz} = 0 $" src="form_236.png"/> (homogeneous Neumann boundary conditions).</li>
<li><img class="formulaInl" alt="$\Gamma_3$" src="form_65.png"/> - Imposed tangential stress <img class="formulaInl" alt="$ n_i \sigma_{iz} = S$" src="form_237.png"/> (non-homogeneous Neumann boundary conditions).</li>
</ul>
<h2><a class="anchor" id="weak_form"></a>
The Weak Form</h2>
<p>In order to solve the equation using the Finite Element Method we need to derive the weak form. We will begin with the partial differential equation that governs the dicplacement in a visco-elastic medium under the anti-plane shear approximation:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \partial_i \left( \mu \partial_i u_z\right) = f^v_z \]" src="form_225.png"/>
</p>
<p>First we multiply the equation from the left by a test function <img class="formulaInl" alt="$v$" src="form_68.png"/>, and then we integrate over the whole domain:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_{\Omega} v \cdot \partial_i \left( \mu \partial_i u_z \right) = \int_{\Omega} v \cdot \partial_i \left( 2 \mu \varepsilon^v_{iz} \right) \]" src="form_254.png"/>
</p>
<p>Integrating by parts both sides of the equation and using the Gauss theorem</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_{\Omega} \partial_i v \cdot \mu \partial_i u_z = \int_{\Omega} \partial_i v \cdot 2 \mu \varepsilon^v_{iz} + \int_{\partial \Omega} v \cdot \mu n_i \partial_i u_z - \int_{\partial \Omega} v \cdot n_i 2 \mu \varepsilon^v_{iz} \]" src="form_232.png"/>
</p>
<p>Considering that:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma_{iz} = 2 \mu \left( \varepsilon_{iz} - \varepsilon^v_{iz} \right) \]" src="form_238.png"/>
</p>
<p>The boundary term can be rewriten as:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_{\Omega} \partial_i v \cdot \mu \partial_i u_z = \int_{\Omega} \partial_i v \cdot 2 \mu \varepsilon^v_{iz} + \int_{\partial \Omega} v \cdot n_i \sigma_{iz} \]" src="form_234.png"/>
</p>
<p>or:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \partial_i v, \mu \partial_i u_z \right)_{\Omega} = \left( \partial_i v, 2 \mu \varepsilon^v_{iz} \right)_{\Omega} + \left(v, n_i \sigma_{iz} \right)_{\partial \Omega} \]" src="form_235.png"/>
</p>
<p>where the operator <img class="formulaInl" alt="$(a, b)$" src="form_80.png"/> is <img class="formulaInl" alt="$ \int a \cdot b $" src="form_81.png"/>.</p>
<p>In those boundaries where the displacement is imposed (Dirichlet boundary conditions), this is <img class="formulaInl" alt="$\Gamma_0$" src="form_59.png"/> and <img class="formulaInl" alt="$\Gamma_1$" src="form_61.png"/>,the test function <img class="formulaInl" alt="$v = 0$" src="form_77.png"/>. The contribution of those boundaries in which the imposed tangential stress is zero (i.e., <img class="formulaInl" alt="$\Gamma_2$" src="form_63.png"/>) will not contribute to the right hand side either. On the other hand,those boundaries in which we impose a non-zero tangential stress (non-homogeneous Neumann boundary conditions), this is <img class="formulaInl" alt="$\Gamma_3$" src="form_65.png"/>, the test functions <img class="formulaInl" alt="$v \neq 0$" src="form_78.png"/>, and that part of the boundary integral has to be included in the weak form.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left( \partial_i v, \mu \partial_i u_z \right)_{\Omega} = \left( \partial_i v, 2 \mu \varepsilon^v_{iz} \right)_{\Omega} + \left(v, S \right)_{\Gamma^3} \]" src="form_239.png"/>
</p>
<p>where <img class="formulaInl" alt="$S$" src="form_82.png"/> is the imposed tangential stress at the boundares <img class="formulaInl" alt="$ \Gamma_3 $" src="form_240.png"/>.</p>
<p>We can now replace the exact solution <img class="formulaInl" alt="$ u_z $" src="form_115.png"/> for an approximate solution in terms of the shape functions, <img class="formulaInl" alt="$ \sum_{k} U_k v_k(x_i) $" src="form_255.png"/>. Here <img class="formulaInl" alt="$U_k$" src="form_256.png"/> are the expansion coefficients we need to determine to find the approximate solution to the equation. Then, the problem is reduced to solving</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[AU=B\]" src="form_86.png"/>
</p>
<p>where the matrix A and the vector B are defined as:</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[A_{kl} = (\partial_i v_k, \mu \partial_i v_l)_{\Omega}\]" src="form_257.png"/>
</p>
 <p class="formulaDsp">
<img class="formulaDsp" alt="\[B_k = (\partial_i v_k, 2 \mu \varepsilon^v_{iz})_\Omega + (v_k, S)_{\Gamma_3} \]" src="form_245.png"/>
</p>
<p>where <img class="formulaInl" alt="$ k $" src="form_258.png"/> and <img class="formulaInl" alt="$ l $" src="form_259.png"/> run through all the degrees of freedom.</p>
<h2><a class="anchor" id="adaptive_refinement"></a>
Adaptive Mesh Refinement in Time Dependent Problems</h2>
<p>Every time step we need to use the solution and the viscous strain from the previous time step. The old solution is stored in a <a href="https://www.dealii.org/8.4.0/doxygen/deal.II/classVector.html">Vector</a> with as many elements as the degrees of freedom the problem has, and is updated every time step. The old viscous strain is stored at each quadrature and can be accessed through a user pointer that each cell holds.</p>
<p>Every time the mesh is refined, the number of cells and degrees of freedom changes, therefore, as part of the mesh refinement we need to transfer the solution vector and the old viscous strain from the old mesh to the new one. For the solution vectors we just need to use <a href="https://www.dealii.org/8.4.0/doxygen/deal.II/classSolutionTransfer.html">SolutionTransfer</a> (see for example <a href="https://www.dealii.org/8.2.0/doxygen/deal.II/step_26.html#codeHeatEquationrefine_meshcode">Step-26</a>). Transferring the old viscous strin is slightly more complicated, we first need to transfer the data stored in the quadrature points to a finite element field that is defined everywhere so that we can later transfer it to the new mesh (using <a href="https://www.dealii.org/8.4.0/doxygen/deal.II/classSolutionTransfer.html">SolutionTransfer</a> and then interpolate it to the new quadrature points. We need a discontinuous field that matches the values in the quadrature points (we will use a Discontinuous Galerking finite element <a href="https://www.dealii.org/8.2.0/doxygen/deal.II/classFE__DGQ.html">FE_DGQ</a>). </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Oct 5 2016 16:08:47 for Viscoelastic Fault -  Elastic approach by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
